---
import { getCollection } from "astro:content";
import Command from "../../components/Command.astro";
import Terminal from "../../components/Terminal.astro";
import Layout from "../../layouts/Layout.astro";

const allBlogPosts = await getCollection("blog");
const sortedPosts = allBlogPosts.sort(
  (a: any, b: any) => b.data.date.getTime() - a.data.date.getTime(),
);
---

<Layout
  title="Blog - Austin Schneider"
  description="Technical writings and thoughts on software development"
>
  <Terminal>
    <Command command="cd ~/blog && ls -la" />
    <div class="mb-4">
      <span class="text-muted">total {sortedPosts.length}</span>
    </div>
    <ul class="space-y-6">
      {
        sortedPosts.map((post: any) => (
          <li>
            <a
              href={`/blog/${post.slug}`}
              class="block hover:bg-fg transition-colors p-2 -mx-2"
            >
              <div class="flex flex-col sm:flex-row sm:justify-between sm:items-baseline gap-1">
                <span class="text-accent font-bold">{post.data.title}</span>
                <span class="text-muted text-sm">
                  {post.data.date.toLocaleDateString("en-US", {
                    year: "numeric",
                    month: "short",
                    day: "numeric",
                  })}
                </span>
              </div>
              <div class="text-muted text-sm mt-1">{post.data.description}</div>
              {post.data.tags && (
                <div class="flex gap-2 mt-2">
                  {post.data.tags.map((tag: string) => (
                    <span class="text-xs text-accent">#{tag}</span>
                  ))}
                </div>
              )}
            </a>
          </li>
        ))
      }
    </ul>
  </Terminal>

  <Terminal>
    <Command command="cat navigation.txt" />
    <p>
      <a href="/">‚Üê Back to home</a>
    </p>
  </Terminal>
</Layout>
